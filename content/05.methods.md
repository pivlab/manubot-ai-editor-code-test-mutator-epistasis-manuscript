## Materials and Methods

### Identifying *de novo* germline mutations in the BXDs

The BXD resource encompasses a total of 152 recombinant inbred lines (RILs), which were derived through various methods.
Specifically, these lines originated from either F2 or advanced intercrosses, followed by inbreeding through brother-sister mating for as many as 180 generations, as detailed by [@PMID:33472028].
The creation of BXDs occurred over several distinct breeding "epochs," each initiated by a unique cross of C57BL/6J and DBA/2J parent strains.
Epochs 1, 2, 4, and 6 originated from F2 crosses, whereas epochs 3 and 5 were the result of advanced intercrosses [@PMID:33472028].
In our previous work, we conducted an analysis of whole-genome sequencing data from the BXD lines, through which we identified candidate *de novo* germline mutations present in each line [@PMID:35545679].
The methodologies employed for DNA extraction, sequencing, alignment, and variant processing, in addition to the characteristics of the identified *de novo* mutations, have been comprehensively described in a preceding manuscript [@PMID:35545679].

In our study, we meticulously identified unique single-nucleotide mutations present in each BXD strain that were not found in any other BXD strains, nor in the parental C57BL/6J and DBA/2J strains.
For a private variant to be included in our analysis, it had to fulfill several stringent criteria:

- The variant needed to be genotyped as either homozygous or heterozygous for the alternate allele, with the alternate allele being supported by at least 90% of the sequencing reads.
This criterion ensures a high confidence in the presence of the alternate allele.
  
- It was essential for the variant to be supported by a minimum of 10 sequencing reads.
This threshold was set to ensure that the observed variant was not a result of sequencing errors.

- The variant required a Phred-scaled genotype quality score of at least 20, indicating that the probability of a genotyping error is less than 1%.

- The variant could not overlap with regions of the genome annotated as segmental duplications or simple repeats according to the GRCm38/mm10 reference.
This is because such regions are prone to sequencing and alignment errors, which could lead to false identification of variants.

- Lastly, the variant had to occur on a parental haplotype that was inherited by at least one other BXD at the same locus.
Furthermore, these other BXDs must be homozygous for the reference allele at the variant site.
This criterion was included to ensure that the identified variant was indeed a private mutation specific to a single BXD strain, rather than a common variant or a sequencing artifact.

By adhering to these criteria, we aimed to robustly identify private single-nucleotide mutations that are specific to individual BXD strains, minimizing the chances of including false positives in our analysis.

### A new approach to discover germline mutator alleles

#### Calculating aggregate mutation spectrum distance

We developed a new approach to discover loci that affect the germline *de novo* mutation spectrum in biparental RILs (Figure @fig:distance-method).

We assume that a collection of haplotypes has been genotyped at informative markers, and that *de novo* germline mutations have been identified on each haplotype.

In our analysis, we categorize haplotypes at each informative marker based on the parental allele they carry.
Subsequently, we calculate a $k$-mer mutation spectrum for each haplotype group by aggregating mutation counts.
The $k$-mer mutation spectrum quantifies the frequency of every possible mutation type across a set of mutations, encapsulated in a vector of dimensions $6 \times 4^{k - 1}$.
This vectorization is achieved after accounting for strand complementarity.
To illustrate, the spectrum for 1-mer mutations is represented by a vector with six elements, detailing the frequencies of six mutation types: C>T, C>G, C>A, A>G, A>T, and A>C.
Given the unique mechanism behind C>T transitions at CpG sites—predominantly the spontaneous deamination of methylated cytosine—we further refine the 1-mer mutation spectrum to distinctly account for CpG>TpG mutations, as highlighted in previous research [@PMID:19488047].

$$
\text{Mutation Spectrum Vector} = 6 \times 4^{k - 1}
$$

Here, the Mutation Spectrum Vector encapsulates the mutation frequencies for a given $k$-mer size, where $k$ represents the length of the DNA sequences considered.
This approach allows for a comprehensive analysis of mutation patterns, taking into account the specific context of each mutation event.

In our analysis, we calculate the cosine distance between the aggregate mutation spectra at each marker.
The cosine distance, $D^C$, between two vectors $\mathbf{A}$ and $\mathbf{B}$ is mathematically expressed as:

$$
D^C = 1 - \frac{\mathbf{A} \cdot \mathbf{B}}{||\mathbf{A}|| \ ||\mathbf{B}||}
$$

In this equation, $||\mathbf{A}||$ and $||\mathbf{B}||$ denote the $L^2$ (Euclidean) norms of vectors $\mathbf{A}$ and $\mathbf{B}$, respectively.
The Euclidean norm of a vector $\mathbf{X}$ is calculated as the square root of the sum of the squares of its components, providing a measure of its magnitude in the multidimensional space.

The choice of cosine distance as a metric offers several advantages for comparing mutation spectra.
Notably, it normalizes for the magnitude of the vectors, allowing for meaningful comparisons between two spectra that may have different total mutation counts, including cases where these counts are relatively low.
Furthermore, by utilizing cosine distance, we circumvent the necessity for individual comparisons of mutation counts across each specific $k$-mer mutation type, streamlining the analysis process.

In our study titled "Epistasis between mutator alleles contributes to germline mutation rate variability in laboratory mice," which focuses on the interplay of mutator alleles and their impact on mutation rate variability in mice, we incorporated methodologies aligned with quantitative trait locus (QTL) mapping strategies.
These strategies have been previously detailed in seminal works by Churchill and Doerge (1994) [@PMID:7851788] and more recently by Marigorta and Navarro (2019) [@PMID:30591514].
Specifically, we employed permutation tests to define genome-wide significance thresholds based on cosine distance measures.
This approach involves conducting a series of $N$ permutation trials, where $N$ is typically set to 10,000.
During each trial, we randomly shuffle the per-haplotype mutation data, effectively dissociating haplotype labels from their corresponding mutation counts.
Subsequently, we utilize the shuffled data to carry out a genome-wide scan, adhering to the methodology previously outlined, and document the maximum cosine distance observed at any given locus.

The mathematical expression for cosine distance, which is pivotal in our analysis, is given by:

$$
d_{\text{cosine}} = 1 - \frac{\mathbf{A} \cdot \mathbf{B}}{\|\mathbf{A}\| \|\mathbf{B}\|}
$$ {#eq:cosine_distance}

where $\mathbf{A}$ and $\mathbf{B}$ represent the mutation count vectors for two haplotypes, $\mathbf{A} \cdot \mathbf{B}$ denotes the dot product of vectors $\mathbf{A

#### Estimating confidence intervals around AMSD peaks

To estimate confidence intervals for identified peaks of adjusted cosine distance on specific chromosomes, we employed a bootstrap resampling technique as described by Efron and Tibshirani (1996) [@PMID:8725246].
For this process, we conducted $N = 10,000$ trials, during which we resampled the mutation spectrum data alongside the corresponding marker genotypes for the chromosome under investigation, ensuring replacement occurred.
With these resampled datasets, we proceeded to execute an aggregate mutation spectrum distance scan across the designated chromosome, meticulously noting the marker position that exhibited the highest adjusted cosine distance metric.
Subsequently, we delineated a 90% confidence interval by pinpointing two marker positions that encapsulated 90% of the peak cosine distance values from all $N$ bootstrap samples.
Specifically, the 90% confidence interval boundaries were determined by identifying the markers that corresponded to the 5th and 95th percentiles within the distribution of peak adjusted cosine distance values across the $N$ bootstrap iterations.

However, it is crucial to acknowledge the limitations associated with the bootstrap method in the context of QTL (Quantitative Trait Loci) mapping studies, as highlighted by Visscher et al.
(2006) [@PMID:16783000].
Notably, bootstrap confidence intervals are generally wider than those derived from alternative approaches such as the "LOD (Logarithm of the Odds) drop" method or Bayes credible intervals.
Furthermore, these intervals often demonstrate suboptimal coverage, implying they may not reliably encompass the true location of the QTL.

#### Accounting for relatedness between strains 

In the study, it is anticipated that each BXD strain will inherit approximately 50% of its genome from the C57BL/6J parent and 50% from the DBA/2J parent.
Consequently, it is probable that any two BXD strains will share identical genotypes at a certain proportion of genetic markers.
Furthermore, BXD pairs that are more genetically alike may exhibit mutation spectra that are more similar as well, which could be attributed to shared polygenic influences on the mutation process.
Hence, at a specific genetic marker, if the BXD strains that have inherited the *D* alleles from DBA/2J exhibit greater genetic dissimilarity to those that have inherited the *B* alleles from C57BL/6J (when considering the overall genomic genetic similarity), it is plausible to expect that the combined mutation spectra of the two groups would also display greater dissimilarity.

To address potential complications arising from relatedness, our methodology incorporates a straightforward strategy.
For each genetic marker, denoted as $g_i$, we categorize BXD haplotypes into two distinct clusters based on the parental allele they possess.
Initially, we calculate the combined mutation spectrum for each haplotype group and then determine the cosine distance ($D^{C}_{i}$) between the two comprehensive spectra.
Subsequently, within each haplotype cluster, we ascertain the frequency of the *D* allele at every marker across the genome, resulting in a frequency vector of length $n$, where $n$ signifies the total number of markers analyzed.
To evaluate the genetic resemblance between the two haplotype groups, we compute the Pearson correlation coefficient, represented as $r_i$, between their respective vectors of genome-wide *D* allele frequencies.

$$
D^{C}_{i} = \frac{\sum_{k=1}^{K} A_{ik}B_{ik}}{\sqrt{\sum_{k=1}^{K} A_{ik}^2} \cdot \sqrt{\sum_{k=1}^{K} B_{ik}^2}}
$$ {#eq-cosine-distance}

$$
r_i = \frac{\sum_{j=1}^{n} (X_{j} - \bar{X})(Y_{j} - \bar{Y})}{\sqrt{\sum_{j=1}^{n} (X_{j} - \bar{X})^2}\sqrt{\sum_{j=1}^{n} (Y_{j} - \bar{Y})^2}}
$$ {#eq-pearson-correlation}

In these equations, $D^{C}_{i}$ represents the cosine distance between the aggregate mutation spectra of the two groups at marker $g_i$, with $

At every genetic marker $g_i$ along the genome, we categorize BXD haplotypes into two distinct groups.
For each group, we calculate two key metrics: $D^{C}_{i}$, representing the cosine distance between the aggregate spectra of the two groups, and $r_i$, denoting the correlation between the genome-wide frequencies of the *D* allele across the two groups.
To mitigate the influence of genetic similarity on the cosine distances, we employ an ordinary least-squares model to regress the set of cosine distances $\left(D^C_{1}, D^C_{2}, ..., D^C_{n} \right)$ against the set of correlations $\left( r_1, r_2, ..., r_n \right)$ for all $n$ markers.
The residuals obtained from this model are then considered as the "adjusted" cosine distance values for each marker.

$$
D^{C}_{i} = \text{cosine distance between the two groups' aggregate spectra at marker } g_i
$$
{#eq:cosine_distance}

$$
r_i = \text{correlation between genome-wide *D* allele frequencies in the two groups at marker } g_i
$$
{#eq:correlation}

In this context, $D^{C}_{i}$ is a measure of the genetic dissimilarity between the two groups at each marker, while $r_i$ assesses the overall genetic likeness across the genome.
Should the genome-wide genetic similarity between haplotypes precisely forecast the cosine distances at each marker, the residuals from our model would approach zero, indicating a perfect prediction.
Conversely, if genome-wide genetic similarity lacks predictive capability, the residuals will reflect the disparity between the observed cosine distance at a single marker and the overall mean of cosine distances across markers.

#### Accounting for BXD population structure due to breeding epochs

The BXD mouse family utilized in our study was developed over six distinct breeding phases, referred to as "epochs." This breeding strategy commenced with a unique cross between C57BL/6J and DBA/2J parent strains for each epoch.
Specifically, BXDs from four of these epochs were produced via F2 crosses between C57BL/6J and DBA/2J strains, while the remaining two epochs involved BXDs derived from advanced intercrosses.
This methodology resulted in several notable differences among the BXD epochs.
For instance, the BXDs that originated from the third and fifth epochs, which were products of advanced intercrosses, exhibited a higher number of fixed recombination breakpoints compared to those from the first, second, fourth, and sixth epochs [@PMID:33472028].
Despite the C57BL/6J and DBA/2J parent strains being fully inbred and thus genetically homogeneous at the outset of each epoch, they each carried a small set of unique *de novo* germline mutations.
These mutations were subsequently passed on to a significant portion of their progeny.
Several of these epoch-specific genetic variants have been associated with the phenotypic differences observed among BXDs from different epochs [@PMID:33472028; @PMID:31274109; @PMID:30984232; @PMID:31057322].

To address the potential impact of population structure and epoch-specific effects on our analysis, we enhanced our methodology by incorporating stratified permutation tests into our aggregate mutation spectrum distance approach.
Typically, in a standard permutation test involving *N* permutations, the per-haplotype mutation spectrum data are shuffled in such a way that the haplotype labels no longer match their original mutation spectra.
This process involves shuffling mutation spectra *across* different epochs.
However, in our stratified permutation approach, we shuffle the per-haplotype mutation data *within* each epoch.
This modification preserves the integrity of the epoch structure while still facilitating the permutation of mutation spectra.

> We used this epoch-aware approach for all permutation tests presented in this manuscript.


#### Implementation and source code

The aggregate mutation spectrum distance method was implemented in Python, and relies heavily on the following Python libraries: `numpy`, `pandas`, `matplotlib`, `scikit-learn`, `pandera`, `seaborn`, and `numba` [@doi:10.1038/s41586-020-2649-2;@doi:10.5281/zenodo.3509134;@doi:10.1109/MCSE.2007.55;@url:https://jmlr.csail.mit.edu/papers/v12/pedregosa11a.html;@doi:10.25080/Majora-342d178e-010;@doi:10.21105/joss.03021;@doi:10.1145/2833157.2833162].

The code underlying AMSD, as well as documentation of the method, is available on GitHub (https://github.com/quinlan-lab/proj-mutator-mapping).
We have also deposited a reproducible Snakemake [@doi:10.12688/f1000research.29032.1] workflow for running reproducing all analyses and figures presented in the manuscript.

### Simulations to assess the power of the aggregate mutation spectrum distance approach

We performed a series of simple simulations to estimate our power to detect alleles that affect the germline mutation spectrum using the aggregate mutation spectrum distance method.

#### Simulating genotypes 

To simulate genotypes within a population of haplotypes across a specified set of sites, we construct a matrix, denoted as $G$, with dimensions $(s, h)$, where $s$ represents the number of sites and $h$ signifies the number of haplotypes under consideration.
It is presupposed that each site is biallelic and maintains a minor allele frequency of 0.5, reflecting equal representation of alleles.
For each matrix element $G_{i,j}$, a value is assigned based on a random draw from a uniform distribution within the range $[0.0, 1.0)$.
Specifically, if the drawn value is less than 0.5, $G_{i,j}$ is set to $1$, indicating the presence of the minor allele.
Conversely, if the value is 0.5 or greater, $G_{i,j}$ is set to $0$, indicating the presence of the major allele.
This approach ensures a balanced representation of alleles across the simulated haplotypes.

#### Defining expected mutation type probabilities

Next, we define a vector of 1-mer mutation probabilities:

$$P = \left( 0.29, \ 0.17, \ 0.12, \ 0.075, \ 0.1, \ 0.075, \ 0.17 \right)$$

The probabilities described sum to unity, reflecting the anticipated distribution of C>T, CpG>TpG, C>A, C>G, A>T, A>C, and A>G *de novo* germline mutations in laboratory mice, as outlined in the literature [@PMID:31492841].
To model the 3-mer mutation spectrum, we adjust the mutation probability vector $P$ to encompass 96 distinct 3-mer mutation types.
Each type is allocated a probability $\frac{P_c}{16}$, where $P_c$ represents the probability of the central mutation within the 3-mer context.
Consequently, for the 16 conceivable N<ins>C</ins>N>N<ins>T</ins>N 3-mer mutation types, the mutation probability is determined as $\frac{P_c}{16} = \frac{0.46}{16} = 0.02875$.
To simulate a specific number of mutations ($m$), we scale the mutation probabilities accordingly, resulting in a vector of lambda ($\lambda$) values:

$$
\lambda = P \cdot m
$$

Here, $P$ denotes the vector of mutation probabilities, and $m$ represents the total number of mutations intended for simulation.

We also create a second vector of lambda values ($\lambda^{\prime}$), in which we multiply the $\lambda$ value of a single mutation type by the mutator effect size $e$.

In our study, instead of simulating a constant mean number of mutations ($m$) across all haplotypes, we conducted a series of simulations where the mean number of mutations for each haplotype was allowed to fluctuate.
This approach was motivated by the observation that BXD Recombinant Inbred Lines (RILs) have been inbred for varying numbers of generations, leading to a differential accumulation of *de novo* germline mutations across the BXD lines, as reported by previous research [@PMID:35545679].
To better mimic the genetic diversity observed in BXD haplotypes, we designed our simulations so that the number of mutations ($m$) for each haplotype was selected from a uniform distribution ranging from $m$ to $20m$.
Specifically, we generated a vector of mutation counts, $M$, consisting of $h$ integers evenly distributed from $m$ to $20m$, where $h$ represents the total number of haplotypes being simulated.
Consequently, if the simulation was set to generate between 100 and 2,000 mutations across 50 haplotypes, the value for the $i$th entry in $M$ would be calculated as $100 + \frac{(2,000 - 100)}{49}i$. 

$$
M_i = 100 + \frac{(2,000 - 100)}{49}i
$$ {#eq:m_i}

In this equation, $M_i$ represents the mean number of mutations for the $i$th haplotype, and $i$ is the index of the haplotype within the vector $M$.
The assignment of the mean number of mutations for each haplotype was then determined by referencing the haplotype's index $i$ in $M$.
This methodological adjustment ensures a more realistic simulation of the genetic variability found within the BXD mouse population, reflecting the natural variation in mutation rates due to differences in the number of generations each line has been inbred.


In our computational simulations, we posit that variations in the genotype at a singular locus, referred to as the "mutator locus," are directly correlated with alterations in the mutation spectrum.
Specifically, at a designated site, denoted as $s_i$, haplotypes harboring alleles denoted by the numeral $1$ are hypothesized to exhibit increased rates of a specific mutation type.
Consequently, these haplotypes derive their mutation counts from a modified rate, $\lambda^{\prime}$, in contrast to haplotypes with alleles denoted by $0$, which are considered to maintain "wild-type" mutation rates and thus draw their mutation counts from $\lambda$.
To implement this model, we randomly select a site $s_i$ to function as the "mutator locus." Subsequently, we ascertain the indices of haplotypes within the genotype matrix $G$ that have been assigned alleles marked as $1$ at site $s_i$.
These indices are denoted as $h_{mut}$.

$$
\lambda^{\prime} > \lambda
$$

where $\lambda$ represents the baseline mutation rate, and $\lambda^{\prime}$ signifies the elevated mutation rate associated with the mutator alleles.

#### Simulating mutation spectra

To simulate the mutation spectrum on our toy population of haplotypes, we define a matrix $C$ of size $(h, n)$, where $n = 6 \times 4^{k - 1}$ (or if $k = 1$ and we include CpG>TpG mutations, $6 \times 4^{k - 1} + 1$).

In the process of analyzing the contribution of epistasis between mutator alleles to germline mutation rate variability in laboratory mice, we meticulously constructed a matrix $C$ to encapsulate the mutation rates for both *mutator* and *wild-type* haplotypes.
For every haplotype represented by a row $i$ in matrix $C$, a critical determination was made regarding its classification: whether it is a *mutator* haplotype, identified by its presence in $h_{mut}$ and thus assigned a $1$ allele at the designated "mutator locus".
In cases where haplotype $i$ was confirmed to be a *mutator*, the elements of $C_i$—the row corresponding to haplotype $i$—were populated using the outcome of a single Poisson distribution draw characterized by parameter $\lambda^{\prime}$.
Conversely, for haplotypes not classified as *mutator* (i.e., not included in $h_{mut}$), the elements of $C_i$ were determined by a single Poisson distribution draw with parameter $\lambda$.

$$
C_i = \begin{cases} 
\text{Poisson}(\lambda

#### Assessing power to detect a simulated mutator allele using AMSD

For each set of parameters, including the number of simulated haplotypes, markers, and the size of the mutator effect, we conducted 100 independent simulations.
In each simulation, we first generated the genotype matrix, denoted as $G$, and the counts of mutations, represented by $C$.
To assess the association between genotypes at a specific site $s_i$ and variations in the mutation spectrum, we computed a measure known as the "focal" cosine distance.
This distance is calculated between the combined mutation spectra of haplotypes that possess different genotypes at the site $s_i$, where an artificial association between genotype variations and mutation spectrum changes has been introduced.

$$
\text{Focal Cosine Distance} = \frac{\sum_{k=1}^{K} A_k B_k}{\sqrt{\sum_{k=1}^{K} A_k^2} \sqrt{\sum_{k=1}^{K} B_k^2}}
$$

where $A_k$ and $B_k$ represent the aggregate mutation counts for the two sets of haplotypes at the $k^{th}$ mutation type, and $K$ is the total number of mutation types considered.

Following the calculation of the focal distance, we performed an aggregate mutation spectrum distance scan over $N = 1,000$ permutations to evaluate the robustness of our method in identifying the mutator allele.
In this context, a permutation refers to a random reshuffling of the association between genotypes and mutation counts.
If fewer than 5% of these permutations yield a cosine distance that is greater than or equal to the calculated focal distance, we interpret this outcome as a successful identification of the mutator allele within that particular simulation.
This threshold criterion is based on a conventional statistical significance level, aiming to ensure that the observed association is not a product of random chance.

#### Assessing power to detect a simulated mutator allele using quantitative trait locus (QTL) mapping

In our study, we further explored the effectiveness of conventional quantitative trait locus (QTL) mapping in identifying loci linked to mutation spectrum variability.
To achieve this, we generated simulated data, including both genotypes and mutation spectra, for a population of haplotypes under a variety of scenarios, such as differing numbers of mutations per haplotype and varying mutator allele effect sizes.
We utilized the software R/qtl2 [@PMID:30591514] for conducting genome scans to identify significant QTLs based on these simulated datasets.
Specifically, we presumed that the genotype markers simulated were uniformly distributed along a single chromosome, measured in physical megabase pair (Mbp) coordinates.

Initially, for each haplotype, we calculated the proportion of *de novo* mutations corresponding to each of the $6 \times 4^{k-1}$ potential $k$-mer mutation types.
This calculation is integral to understanding the mutation spectrum.
Subsequently, we transformed the simulated genotypes at each marker into genotype probabilities.
This transformation was executed using the `calc_genoprob` function provided by R/qtl2, applying a map function designated as "c-f" and setting the error probability (`error_prob`) to 0.

For each $k$-mer mutation type, we then employed these genotype probabilities alongside the per-haplotype mutation fractions to conduct a QTL scan using the `scan1` function.
To ensure the comparability of our results with those obtained through the AMSD method, we opted not to incorporate any covariates or kinship matrices into these QTL scans.
Following this, we executed 1,000 permutations of the per-haplotype mutation fractions using the `scan1perm` function to establish log-odds (LOD) significance thresholds.
We defined a QTL scan as "successful" if it yielded a LOD score surpassing the significance threshold, which was calculated using the formula $\alpha = \frac{0.05}{7}$.

$$
\alpha = \frac{0.05}{7}
$$ {#id}

In this equation, $\alpha$ represents the significance level, adjusted for multiple testing across the seven potential $k$-mer types investigated.
This adjustment is crucial for maintaining an appropriate balance between type I and type II errors in our analysis.

In our simulations, we specifically increased the mutation rate associated with a particular $k$-mer mutation type in haplotypes that contain the mutator allele under study.
It is important to note that, in real-world experiments, it would typically not be possible to know in advance which mutation type is influenced by the mutator allele.
Therefore, utilizing an alpha threshold of 0.05 in our simulations might lead to an overestimation of the effectiveness of quantitative trait locus (QTL) mapping in identifying the mutator allele.
Given that a comprehensive experimental approach would necessitate conducting seven distinct QTL scans—one for each of the six 1-mer mutation types plus an additional scan for the CpG>TpG mutation type—we recalculated the QTL logarithm of odds (LOD) thresholds to account for multiple testing.
This adjustment was made using a Bonferroni correction, resulting in a revised alpha value of $\alpha = \frac{0.05}{7}$.

$$
\alpha = \frac{0.05}{7}
$$

Here, $\alpha$ represents the adjusted alpha threshold for significance after Bonferroni correction, aimed at controlling the family-wise error rate when performing multiple QTL scans.


### Applying the aggregate mutation spectrum distance method to the BXDs

We retrieved previously-generated BXD *de novo* germline mutation data from the GitHub repository linked to our earlier work, which has also been preserved in the Zenodo archive [@url:https://github.com/tomsasani/bxd_mutator_manuscript;@doi:10.5281/zenodo.5941048;@PMID:35545679].
Furthermore, we obtained a CSV file containing BXD genotypes across approximately 7,300 informative markers from the GeneNetwork platform [@url:http://gn1.genenetwork.org/dbdoc/BXDGeno.html;@PMID:27933521].
Additionally, we accessed pertinent metadata concerning each BXD strain from a publication that details the recent enhancements to the BXD resource [@PMID:33472028].
These datasets have been incorporated into the GitHub repository associated with the current manuscript.

As detailed in our preceding work [@PMID:35545679], we analyzed mutation data from a select group of the 152 BXD strains in our comprehensive mutation spectrum distance assessments.
Specifically, we excluded BXD strains that underwent backcrossing with either a C57BL/6J or DBA/2J parent at any stage of their inbreeding cycle, a common practice to mitigate inbreeding depression [@PMID:33472028].
Moreover, BXD68 was omitted from our genome-wide analyses due to its previously identified hyper-mutator phenotype, characterized by a C>A germline mutation rate exceeding five times the average rate across the population.
This anomaly is attributed to a harmful nonsynonymous mutation in the *Mutyh* gene [@PMID:35545679].
In line with our earlier study, BXD strains inbred for less than 20 generations were also excluded.
This criterion is based on the understanding that approximately 20 generations of strict brother-sister mating are required for a recombinant inbred line (RIL) genome to achieve over 98% homozygosity [@url:https://link.springer.com/book/10.1007/978-1-349-04904-2].
Consequently, any mutator allele would likely be either completely fixed or eliminated by this point.
If fixed, the allele could continue to contribute to mutation accumulation throughout the strain's further inbreeding.
Therefore, mutations in the genome of a "young" BXD strain (i.e., inbred for fewer than 20 generations) might not accurately reflect the influence of a mutator allele as effectively as those in a "mature" BXD strain.
This discrepancy posed a significant challenge in our prior attempt to identify mutator alleles using quantitative trait locus mapping, as the mutation rates of both young and mature BXD strains were considered equally, thereby incorporating considerable noise into the mutation spectra of younger strains.
To circumvent this issue in the current study, we opted to include these younger BXD strains in our genome-wide scans, leveraging the aggregate mutation spectrum distance (AMSD) method.
AMSD calculates a cumulative mutation spectrum by incorporating data from all BXD strains sharing a specific allele at a given locus, thus mitigating the effects of sparse and noisy individual mutation spectra.

In total, we included 117 BXDs in our genome-wide scans.

### Identifying candidate single-nucleotide mutator alleles overlapping the chromosome 6 peak

We conducted an examination of the region suggested by our comprehensive mutation spectrum distance methodology on chromosome 6.
This was achieved by narrowing down the joint-genotyped BXD Variant Call Format (VCF) file, accessible through the European Nucleotide Archive under accession PRJEB45429 [@url:https://www.ebi.ac.uk/ena/browser/view/PRJEB45429], utilizing `bcftools` [@PMID:33590861].
The region of interest, identified based on the peak of the cosine distance on chromosome 6, was defined within a 90% bootstrap confidence interval, which spans from approximately 95 Megabase pairs (Mbp) to 114 Mbp.
To assess the potential functional consequences of both single-nucleotide variants (SNVs) and insertions/deletions (indels) on elements such as splicing and protein structure, we annotated variants present in the BXD VCF file.
This annotation was performed using the `snpEff` command as follows [@PMID:22728672]:

```
snpEff command details here
```

In this context, it is essential to define the key symbols used in the equations and analyses:

- **Mbp**: Megabase pairs, a unit of measurement for DNA sequences, indicating the length of a sequence in millions of base pairs.
- **Bootstrap confidence interval**: A statistical method used to estimate the uncertainty of a parameter, in this case, the location of the cosine distance peak on chromosome 6, by resampling the data with replacement.
- **Cosine distance**: A measure used to quantify the similarity between two vectors, in this case, mutation spectra, by calculating the

```
 java -Xmx16g -jar /path/to/snpeff/jarfile GRCm38.75 /path/to/bxd/vcf > /path/to/uncompressed/output/vcf
```

and used `cyvcf2` [@PMID:28165109] to iterate over the annotated VCF file in order to identify nonsynonymous fixed differences between the parental C57BL/6J and DBA/2J strains.

### Identifying candidate structural variant alleles overlapping the chromosome 6 peak

We downloaded summary VCFs containing insertion, deletion and inversion structural variants (identified via high-quality, long-read assembly of inbred laboratory mouse strains [@doi:10.1016/j.xgen.2023.100291]) from the Zenodo link associated with the Ferraj et al.
manuscript: https://doi.org/10.5281/zenodo.7644286.

We then downloaded a TSV file containing RefSeq gene predictions in GRCm39/mm39 from the UCSC Table Browser [@PMID:14681465], and used the `bx-python` library [@url:https://github.com/bxlab/bx-python] to intersect the interval spanned by each structural variant with the intervals spanned by the `txStart` and `txEnd` of every RefSeq entry.

We queried all structural variants within the 90% bootstrap confidence interval on chromosome 6.

### Extracting mutation signatures 

We used SigProfilerExtractor (v.1.1.21) [@PMID:30371878] to extract mutation signatures from the BXD mutation data.
After converting the BXD mutation data to the "matrix" input format expected by SigProfilerExtractor, we ran the `sigProfilerExtractor` method as follows:

```python
# install the mm10 mouse reference data
genInstall.install('mm10')

# run mutation signature extraction
sig.sigProfilerExtractor(
    'matrix',
    /path/to/output/directory,
    /path/to/input/mutations,
    maximum_signatures=10,
    nmf_replicates=100,
    opportunity_genome="mm10",
)
```

### Comparing mutation spectra between Mouse Genomes Project strains

We obtained mutation data from a study that identified strain-specific mutations in 29 mouse strains, which were initially sequenced in the Sanger Mouse Genomes Project (MGP) [@PMID:21921910].
This data was extracted from Supplementary File 1, Excel Table S3 of the referenced analysis [@PMID:30753674].
To analyze the impact of mutator alleles (*D* or *B*) located on chromosome 4 or chromosome 6 on the mutation rates, we compared the counts of each mutation type across MGP strains.
For an accurate comparison, we normalized the mutation counts by the number of callable nucleotides (A, T, C, or G) present in each strain, employing a method previously described [@PMID:35545679].
This adjustment is crucial for ensuring that the mutation rates are comparable across strains with varying genome coverage.

### Querying GeneNetwork for eQTLs at the mutator locus

To identify *cis*-eQTLs for the DNA repair genes implicated beneath the cosine distance peak on chromosome 6, we employed the online GeneNetwork platform [@PMID:27933521].
This resource provides access to both array- and RNA-seq-derived expression measurements across a diverse array of tissues.
From the GeneNetwork homepage (genenetwork.org), we selected the "BXD Family" as the **Group** and navigated through the **Type** dropdown menu to choose the specific expression datasets outlined in Table @tbl:eqtl-provenance.
Subsequently, in the **Get Any** search field, we entered the names of the genes of interest and initiated the search.
Upon locating the relevant trait ID, we proceeded to the **Mapping Tools** dropdown menu, where we executed Hayley-Knott regression [@PMID:16718932] utilizing the default settings, which included 1,000 permutations, interval mapping, the exclusion of cofactors, and the application of WGS-based genotypes from the year 2022.

In our study, if a significant cis-eQTL for the gene of interest was identified, specifically a locus on chromosome 6 exhibiting an LRS (likelihood ratio statistic) greater than or equal to the genome-wide "significant LRS" threshold, a subsequent genome-wide association test for the trait of interest was carried out.
This second test utilized the GEMMA software [@PMID:2453419], employing parameters such as WGS (whole-genome sequencing)-based marker genotypes, a minor allele frequency (MAF) threshold of 0.05, and the leave-one-chromosome-out (LOCO) strategy for analysis.
The combined application of Haley-Knott regression and GEMMA enabled us not only to identify loci surpassing the genome-wide LRS threshold but also to more accurately determine the impact of these loci on gene expression [@doi:10.1101/2020.12.23.424047].

The exact names of the expression datasets we used for each tissue are shown in Table @tbl:eqtl-provenance below:

| Tissue name | Complete name of GeneNetwork expression data | 
| - | - | 
| Kidney | `Mouse kidney M430v2 Sex Balanced (Aug06) RMA` | 
| Gastrointestinal | `UTHSC Mouse BXD Gastrointestinal Affy MoGene 1.0 ST Gene Level (Apr14) RMA` |
| Hematopoetic stem cells | `UMCG Stem Cells ILM6v1.1 (Apr09) transformed` | 
| Spleen | `UTHSC Affy MoGene 1.0 ST Spleen (Dec10) RMA` |  
| Liver | `UTHSC BXD Liver RNA-Seq Avg (Oct19) TPM Log2` | 
| Heart | `NHLBI BXD All Ages Heart RNA-Seq (Nov20) TMP Log2 **` | 
| Hippocampus | `Hippocampus Consortium M430v2 (Jun06) RMA` |

Table: Names of gene expression datasets used for each tissue type on GeneNetwork {#tbl:eqtl-provenance}

### Calculating the frequencies of candidate mutator alleles in wild mice 

To assess the prevalence of the *Ogg1* and *Setmar* nonsynonymous mutations across different mouse populations, we analyzed a Variant Call Format (VCF) file that encapsulates genome-wide variations from 67 wild-derived mice spanning four *Mus* species [@PMID:27622383].
Specifically, we focused on calculating the allele frequencies of these mutations within each of the four species or subspecies, namely *Mus musculus domesticus*, *Mus musculus musculus*, *Mus musculus castaneus*, and *Mus spretus*.
The criteria for including genotypes in our analysis were stringent, requiring:

- a minimum support of 10 sequencing reads,
- and a Phred-scaled genotype quality score of no less than 20.

### Testing for epistasis between the two mutator loci

To test for statistical epistasis between the mutator loci on chromosome 4 and chromosome 6, we modeled C>A mutation rates in the BXDs as a function of genotypes at either locus. 
Specifically, we tested for statistical interaction between genotypes by fitting a generalized linear model in the R statistical language as follows:

```R
m1 <- glm(Count ~ offset(log(ADJ_AGE)) + Genotype_A * Genotype_B, data = data, family=poisson())
```

In this study, we developed a model to analyze the germline mutation rate variability in laboratory mice, specifically focusing on C>A *de novo* mutations observed across different BXD strains.
The model incorporates several key variables and terms to accurately capture the mutation rate dynamics:

- `Count`: Represents the total number of observed C>A *de novo* mutations in each BXD strain.
- `ADJ_AGE`: Calculated as the product of the count of "callable" cytosine/guanine nucleotides (i.e., cytosines/guanines covered by at least 10 sequencing reads) and the number of generations each BXD strain has been inbred.
This term accounts for the genomic coverage and inbreeding duration, which are critical for accurate mutation rate estimation.

$$
ADJ\_AGE = \text{Callable Nucleotides} \times \text{Inbreeding Generations}
$$

In the model, we utilized the logarithm of `ADJ_AGE` as an offset.
This approach allows us to model the response variable (mutation count) as a rate (per base-pair, per generation) rather than an absolute count.
This adjustment is crucial as it accounts for differences across BXD strains in both the duration of inbreeding and the extent of their genomes sequenced to a sufficient depth, which can significantly influence the observed number of mutations.

- `Genotype_A` and `Genotype_B`: These terms represent the genotypes of the BXD strains at two specific genetic markers, `rs27509845` and `rs46276051`.
These markers were selected based on their peak cosine distances on chromosomes 4 and 6, respectively, in two aggregate mutation spectrum distance scans.
For the purpose of our analysis, we focused on the subset of BXD strains (n = 108) that were homozygous at both marker sites.
This restriction allowed us to simplify the model by treating genotypes at these loci as binary variables ("B" or "D").

To evaluate the significance of interaction effects between the mutator alleles at these loci, we employed an analysis of variance (ANOVA).
This statistical method facilitated a comparison between a model that includes both additive and interaction effects and a simpler model that only accounts for additive effects.
Through this approach, we aimed to determine whether the interaction between mutator alleles significantly contributes to the variability in germline mutation rates observed among the BXD strains.

```R
m2 <- glm(Count ~ offset(log(ADJ_AGE)) + Genotype_A + Genotype_B, data = data, family=poisson())
```

```R
anova(m1, m2, test="Chisq")
```

To assess whether the combined effect of *D* genotypes at the two markers, `rs27509845` and `rs46276051`, deviates from a simple additive model, we compared two models: model `m1`, which includes an interaction term between the two markers, and model `m2`, a simpler model that assumes the effects of *D* genotypes at each marker are additive with no interaction.
Specifically, if model `m1` provides a significantly better fit to the data compared to model `m2`, we can reject the null hypothesis positing that the effect of *D* genotypes at both markers is merely the sum of their individual effects at `rs27509845` or `rs46276051`.
In essence, a superior fit of `m1` over `m2` suggests that the interaction between *D* genotypes at these markers is non-additive, thereby indicating the presence of statistical epistasis.

We tested for epistasis in the Sanger Mouse Genomes Project (MGP) strains using a nearly-identical approach.
In this analysis, we fit two models as follows:

```R
m1 <- glm(Count ~ offset(log(CALLABLE_C)) + Genotype_A * Genotype_B, data = data, family=poisson())

m2 <- glm(Count ~ offset(log(CALLABLE_C)) + Genotype_A + Genotype_B, data = data, family=poisson())
```

In our analysis, the count of strain-private C>A mutations observed in each Mouse Genomes Project (MGP) strain, denoted as `Count`, served as a crucial variable [@PMID:30753674].
The term `CALLABLE_C` was defined as the total number of cytosine and guanine nucleotides that were accessible for mutation calling within each strain.
Additionally, the variables `Genotype_A` and `Genotype_B` were used to represent the MGP genotypes at the mutator loci located on chromosomes 4 and 6, respectively.
To evaluate the differences between our two proposed models, we employed Analysis of Variance (ANOVA), adhering to the methodology previously described.

$$
\text{Mutation Rate} = \frac{\text{Count}}{\text{CALLABLE\_C}}
$$

{#eq:mutation_rate}

In Equation (@eq:mutation_rate), the Mutation Rate is calculated as the ratio of the `Count` of strain-private C>A mutations to the `CALLABLE_C`, which signifies the genomic regions accessible for




